<form class="c-dialog c-dialog--average c-dialog--autoHeight" [formGroup]="form" (ngSubmit)="addWorker()">
  <div class="c-dialog__header">
    <p class="c-dialog__title">{{'–î–æ–¥–∞–≤–∞–Ω–Ω—è –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞' | translate}}</p>
    <button class="c-dialog__close" type="button" (click)="closeDialog()">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <div class="c-dialog__body c-dialog__body--padding">
    <p
      class="c-dialog__text c-dialog__text--small">{{'–í–∏ –º–æ–∂–µ—Ç–µ –¥–æ–¥–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∑–∞–∫–ª–∞–¥.' | translate}}</p>
    <ng-container *ngIf="getCitiesSub.closed; else loading">

      <div class="c-dialogForm__row c-dialogForm__row--column">
        <div class="c-dialogForm__col">
          <mat-form-field>
            <mat-label>{{'–í–≤–µ–¥—ñ—Ç—å —ñ–º\'—è –ü—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞' | translate}}</mat-label>
            <label>
              <input type="text" formControlName="name" matInput required>
            </label>
            <mat-error *ngIf="form.get('name').hasError('required')">
              {{'–Ü–º\'—è —î –æ–±–æ–≤\'—è–∑–∫–æ–≤–∏–º' | translate}}
            </mat-error>
          </mat-form-field>
        </div>
        <div class="c-dialogForm__col">
          <mat-form-field>
            <mat-label>{{'–í–≤–µ–¥—ñ—Ç—å email –ü—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞' | translate}}</mat-label>
            <label>
              <input type="text" formControlName="email" matInput required>
            </label>
            <mat-error *ngIf="form.get('email').hasError('required')">
              {{'Email —î –æ–±–æ–≤\'—è–∑–∫–æ–≤–∏–º' | translate}}
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <div class="o-inputPassword__filed">
        <input-password [appearance]="'standard'"
                        [placeholder]="'–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –ü—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞' | translate"
                        [formControl]="form.get('password')"
                        (paste)="false"
                        ngDefaultControl></input-password>
      </div>

      <div class="o-inputPassword__filed">
        <input-password [appearance]="'standard'"
                        [placeholder]="'–ü–æ–≤—Ç–æ—Ä—ñ—Ç—å –ø–∞—Ä–æ–ª—å' | translate"
                        [formControl]="form.get('password_confirmation')"
                        (paste)="false"
                        ngDefaultControl></input-password>
        <mat-error class="o-inputPassword__filedError"
                   *ngIf="form.get('password_confirmation').valid && form.errors?.equivalent">
          {{'–ü–∞—Ä–æ–ª—ñ –Ω–µ –∑–±—ñ–≥–∞—é—Ç—å—Å—è. –ë—É–¥—å –ª–∞—Å–∫–∞, –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–≤–µ–¥—ñ—Ç—å —Å–≤—ñ–π –ø–∞—Ä–æ–ª—å' | translate}}
        </mat-error>
      </div>

      <mat-form-field>
        <mat-label>{{'–í–∫–∞–∂—ñ—Ç—å –∑–∞–∫–ª–∞–¥ –¥–ª—è –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞' | translate}}</mat-label>
        <mat-select
          disableOptionCentering
          formControlName="shop"
          role="listbox"
          required>
          <mat-option>
            <ngx-mat-select-search
              [(ngModel)]="searchEstablishmentValue"
              formControlName="establishmentSearch"
              [placeholderLabel]="'–ó–Ω–∞–π—Ç–∏ –º—ñ—Å—Ç–æ' | translate"
              noEntriesFoundLabel="{{'–¢–∞–∫–æ–≥–æ –º—ñ—Å—Ç–∞ –Ω–µ–º–∞—î' | translate}} üòû"
              [ariaLabel]="'–ó–Ω–∞–π—Ç–∏ –º—ñ—Å—Ç–æ' | translate"></ngx-mat-select-search>
          </mat-option>
          <span *ngFor="let area of establishments">
            <mat-optgroup *ngFor="let region of area.regions | searchEstablishments:searchEstablishmentValue;"
                          [label]="region.name_en | getLocalizationCityKey | translate">
              <mat-option *ngFor="let coffeeShop of region.coffee_shops" [value]="coffeeShop.id" role="listitem">
                {{coffeeShop.address}}
              </mat-option>
            </mat-optgroup>
          </span>
          <mat-option *ngIf="error">{{error}}</mat-option>
          <mat-option
            *ngIf="!establishments?.length && !error">{{'–°–ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞—Ç–∏ –∑–∞–∫–ª–∞–¥.' | translate}}</mat-option>
        </mat-select>
        <mat-error *ngIf="form.get('shop').hasError('required')">
          {{'–ó–∞–∫–ª–∞–¥ —î –æ–±–æ–≤\'—è–∑–∫–æ–≤–∏–º' | translate}}
        </mat-error>
      </mat-form-field>
    </ng-container>
    <ng-template #loading>
      <spinner class="c-dialog__spinner"></spinner>
    </ng-template>

    <mat-error *ngIf="error" class="mat-error">{{error | translate}}</mat-error>
  </div>
  <div class="c-dialog__footer">
    <div class="c-dialog__footerBtns">
      <button class="o-button o-button--secondary" type="submit" [disabled]="!addingSub.closed" matRipple>
        <ng-container *ngIf="addingSub.closed; else addingLoading">
          <span class="o-buttonText">{{'–î–æ–¥–∞—Ç–∏ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞' | translate}}</span>
        </ng-container>
        <ng-template #addingLoading>
          <spinner class="o-buttonSpinner o-buttonSpinner--white"></spinner>
        </ng-template>
      </button>
    </div>
  </div>
</form>
