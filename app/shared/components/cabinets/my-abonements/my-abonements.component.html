<span *ngIf="network"
      class="c-productsMobAction c-productsMobAction--right"
      ngxClipboard [cbContent]="shopLinkForShare()"
      (cbOnSuccess)="copyEstablishmentLink()">
  <mat-icon class="o-shareBtn__icon">reply</mat-icon>
</span>
<div *ngIf="network && isTabletsOrMobiles()" class="swiper-container c-productsSwiper"
     [swiper]="networkEstablishmentsConfig">
  <div class="swiper-wrapper">
    <div class="swiper-slide" (click)="openCoffeeShopPreview(network, -1)">
      <img [src]="API_URL + network.avatar" [alt]="network.name" class="c-productsSwiper__img">
    </div>
    <div class="swiper-slide" *ngFor="let coffeeShop of getCoffeeShopsFromCurrentCity() let i = index"
         (click)="openCoffeeShopPreview(coffeeShop, i)">
      <div class="c-productsSwiper__info">
        <p class="c-productsSwiper__infoTitle">{{coffeeShop.region.name_en | getLocalizationCityKey | translate}}</p>
        <p class="c-productsSwiper__infoText">{{coffeeShop.address}}</p>
        <p class="c-productsSwiper__infoCaption">{{'–¢–∏—Å–Ω—ñ—Ç—å, —â–æ–± —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏' | translate}}</p>
      </div>
      <img [lazyLoad]="API_URL + coffeeShop.img" defaultImage="/assets/img/img-not-loaded.svg"
           alt="{{network.name}} - {{coffeeShop.region.name_en | getLocalizationCityKey | translate}} {{coffeeShop.address}}"
           class="c-productsSwiper__img">
    </div>
    <div class="swiper-slide">
      <div class="c-productsSwiper__content">
        <p class="c-productsSwiper__title">{{'–í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –±—ñ–ª—å—à–µ –∑–∞–∫–ª–∞–¥—ñ–≤.' | translate}}</p>
        <button class="o-button o-button--secondary"
                (click)="openLocation()">{{'–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤—Å—ñ –∑–∞–∫–ª–∞–¥–∏' | translate}}</button>
      </div>
    </div>
  </div>
  <div class="swiper-pagination c-productsSwiper__pagination"></div>
</div>
<div class="c-myAbonements" [ngClass]="{'c-myAbonements--blur': selectedCoffeeShop}">
  <div class="c-cards__header">
    <div class="container">
      <div class="c-cards__headerContent">
        <span class="c-cards__back" (click)="goBack()">
          <mat-icon>arrow_back</mat-icon>
        </span>
        <div class="c-cards__headerPreview previewHover" (click)="network ? openCoffeeShopPreview(network, -1) : false">
          <img *ngIf="network?.avatar" class="c-cards__headerAvatar" defaultImage="/assets/img/img-not-loaded.svg"
               [lazyLoad]="API_URL + network.avatar" [alt]="network.name">
        </div>
        <div class="c-cards__description">
          <h1 class="c-cards__title">{{'–ê–±–æ–Ω–µ–º–µ–Ω—Ç–∏' | translate}}
            <ng-container *ngIf="network">- {{network.name}}</ng-container>
          </h1>
          <h2
            class="c-cards__subTitle">{{'–ü–æ–∫–∞–∂—ñ—Ç—å QR-–∫–æ–¥ –±—É–¥—å —è–∫–æ–≥–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ –≤ –∫–∞–≤\'—è—Ä–Ω—ñ ' | translate}} {{network?.name}} {{' –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–≤–æ—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è' | translate}}</h2>
        </div>
        <span *ngIf="network"
              class="o-shareBtn"
              ngxClipboard [cbContent]="shopLinkForShare()"
              (cbOnSuccess)="copyEstablishmentLink()">
            <mat-icon class="o-shareBtn__icon">reply</mat-icon>
          </span>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="c-myAbonements__content">
      <div class="c-myAbonementsList__wrapper">
        <ng-container *ngIf="getAbonementsSub.closed; else loading">
          <ng-container *ngIf="!error; else isErrorTemplate">
            <ng-container *ngIf="abonements.length; else empty">
              <notification *ngIf="deletedAbonements().length"
                            [isEmitter]="true"
                            (clickEmit)="getAbonements(this.currentEstablishmentSlug, true)"
                            [NotificationType]="NotificationType.Bonuses"
                            [btnTitle]="'–ó–∞—Ä–∞—Ö—É–≤–∞—Ç–∏ –±–æ–Ω—É—Å–∏' | translate"
                            [title]="'–î–µ—è–∫—ñ –≤–∞—à—ñ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∏ –±—É–ª–∏ –≤–∏–¥–∞–ª–µ–Ω—ñ –º–µ—Ä–µ–∂–µ—é —É –∑–≤\'—è–∑–∫—É –∑ —Ç–∏–º, —â–æ –≤–æ–Ω–∞ –±—ñ–ª—å—à–µ –Ω–µ —Ä–µ–∞–ª—ñ–∑—É—î –¥–∞–Ω—É –ø—Ä–æ–¥—É–∫—Ü—ñ—é. –ù–∞ –∑–∞–º—ñ–Ω—É –≤–∏–¥–∞–ª–µ–Ω–∏—Ö –∞–±–æ–Ω–µ–º–µ–Ω—Ç—ñ–≤ –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ ' + deletedAbonementsBonuses() + '–≥—Ä–Ω. –±–æ–Ω—É—Å–Ω–∏—Ö –∫–æ—à—Ç—ñ–≤ –≤ –¥–∞–Ω—ñ–π –∫–∞–≤\'—è—Ä–Ω—ñ.' | translate">
              </notification>
              <ul class="c-myAbonementsList">
                <li class="c-myAbonementsList__item" *ngFor="let abonement of abonements" [ngClass]="{'deleted': isDeletedAbonement(abonement)}">
                  <div class="c-myAbonementsList__itemInfo">
                    <div class="c-myAbonementsList__preview previewHover" (click)="openAbonementPreview(abonement)">
                      <img
                        [lazyLoad]="abonement.product? API_URL + abonement.product.img : '/assets/img/img-not-loaded.svg'"
                        defaultImage="/assets/img/img-not-loaded.svg"
                        [alt]="abonement.product ? abonement.product.name : abonement.product_name"
                        class="c-myAbonementsList__img">
                      <span class="c-myAbonementsList__badge">{{'–ê–±–æ–Ω–µ–º–µ–Ω—Ç' | translate}}</span>
                      <span *ngIf="isNewAbonement(abonement)" class="c-myAbonementsList__badge c-myAbonementsList__badge--new">{{'–ù–æ–≤–∏–π' | translate}}</span>
                    </div>
                    <div class="c-myAbonementsList__description">
                      <p class="c-myAbonementsList__title">
                        {{abonement.product ? abonement.product.name : abonement.product_name}}
                      </p>
                      <p *ngIf="abonement.product && abonement.product.capacity" class="c-myAbonementsList__capacity">
                        {{'–Ñ–º–Ω—ñ—Å—Ç—å:' | translate}} {{abonement.product.capacity.size}}{{abonement.product.capacity.unit}}
                      </p>
                      <p *ngIf="isDeletedAbonement(abonement)" class="c-myAbonementsList__text">
                        {{'–î–µ—è–∫—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –¥–∞–Ω–æ–≥–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç—É –±—ñ–ª—å—à–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ. –†–æ–∑–≥–æ—Ä–Ω—ñ—Ç—å, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏.' | translate}}
                      </p>
                      <p class="c-myAbonementsList__count">{{'–ö—ñ–ª—å–∫—ñ—Å—Ç—å' | translate}}: {{abonement.quantity}}</p>
                    </div>
                  </div>
                  <button class="c-myAbonementsList__btn" (click)="openAbonementPreview(abonement)">
                    {{'–í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏' | translate}}
                  </button>
                </li>
              </ul>
            </ng-container>
            <ng-template #empty>
              <div class="c-cards__empty">
                <p class="c-cards__emptyTitle">
                  {{'–£ –≤–∞—Å —â–µ –Ω–µ–º–∞—î –Ω—ñ—è–∫–∏—Ö –∞–±–æ–Ω–µ–º–µ–Ω—Ç—ñ–≤.' | translate}} üòß
                </p>
                <p class="c-cards__emptyText">
                  {{'–í–∏–±–µ—Ä—ñ—Ç—å –º—ñ—Å—Ç–æ —ñ –∑–∞–∫–ª–∞–¥ –≤ –Ω—å–æ–º—É –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –ø—Ä–∏–¥–±–∞—Ç–∏ –∞–±–æ–Ω–µ–º–µ–Ω—Ç.' | translate}}
                </p>
              </div>
            </ng-template>
          </ng-container>
          <ng-template #isErrorTemplate>
            <div class="c-cards__empty">
              <p class="c-cards__emptyText">{{error | translate}}</p>
            </div>
          </ng-template>

          <network-info *ngIf="network"
                        [network]="network"
                        [networkLoaded]="getAbonementsSub.closed"
                        [isMobile]="true"></network-info>
        </ng-container>
        <ng-template #loading>
          <spinner class="c-cards__spinner"></spinner>
        </ng-template>
      </div>

      <div class="c-myAbonementsBasket__wrapper">
        <shopping-cart [network]="network"
                       [friendsData]="friendsData"
                       [pageLoaded]="getAbonementsSub.closed"
                       [currentCartType]="cartType.MyAbonements"></shopping-cart>

        <network-info *ngIf="network" [network]="network" [networkLoaded]="getAbonementsSub.closed"></network-info>
      </div>
    </div>
  </div>
</div>

<shopping-cart [isMobile]="true"
               [network]="network"
               [friendsData]="friendsData"
               [pageLoaded]="getAbonementsSub.closed"
               [currentCartType]="cartType.MyAbonements"></shopping-cart>

